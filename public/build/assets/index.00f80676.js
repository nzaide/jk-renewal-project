new Vue({el:"#app",data(){return{industries:{data:[],defaultUrl:"/admin/industries",search:"",modalTitle:"Industry"},job_fields:{data:[],defaultUrl:"/admin/job-fields",search:"",modalTitle:"Field and Job Title"},jobs:{data:[],defaultUrl:"/admin/jobs",search:"",modalTitle:"Interested Jobs"},other_tags:{data:[],defaultUrl:"/admin/other-tags",search:"",modalTitle:"Other Tags"}}},created(){this.fetchData("industries"),this.fetchData("job_fields"),this.fetchData("jobs"),this.fetchData("other_tags")},methods:{setUpsertModal(a,t,l=null,d="",o=!1){let n=this[a].defaultUrl;l!=null&&(n+="/"+l),document.getElementById("upsertForm").action=n,document.getElementById("upsertForm").method=t,document.getElementById("name").value=d,document.getElementById("is_sub").value=o,document.getElementById("parentSelect").hidden=!o;let i=document.getElementsByClassName("parent-option");for(let e of i)e.hidden=!0,e.dataset.type==a&&(e.hidden=!1,e.selected=parseInt(e.value)===o);let r=document.getElementsByClassName("validation-msg");for(let e of r)e.innerHTML="";let s="";t=="POST"&&(s="Add "),t=="PUT"&&(s="Edit "),s+=this[a].modalTitle,o?s+=" - sub category":s+=" - main category",document.getElementById("upsertModalTitle").innerHTML=s},setDeleteModal(a,t){document.getElementById("deleteForm").action=this[a].defaultUrl+"/"+t},async submitForm(a){const t=document.querySelector('meta[name="csrf-token"]').getAttribute("value"),l=a+"Form",d=document.getElementById(l).action,o=document.getElementById(l).attributes.method.value;let n={show_collapse:{}},i=document.getElementsByClassName("collapse");for(let e of i)e.classList.contains("show")&&(n.show_collapse[e.id]=!0);let r=document.getElementById(l).getElementsByClassName("input");for(let e of r)n[e.name]=e.value;const s=await(await fetch(d,{method:o,headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":t,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(n)})).json();if(s.errors){let e=document.getElementsByClassName("validation-msg");for(let m of e){m.innerHTML="";let c=s.errors[m.dataset.name];c&&(m.innerHTML=c[0])}}else window.location.reload()},async fetchData(a,t=null,l=""){t||(t="/api"+this[a].defaultUrl+"?search="+l),this[a].data=await(await fetch(t)).json()}}});
