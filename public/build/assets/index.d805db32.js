new Vue({el:"#app",data(){return{admins:{data:[],currentPage:1,lastPage:null,defaultUrl:"/api/admin/admins",total:0},job_posts:{data:[],currentPage:1,lastPage:null,defaultUrl:"/api/admin/job-posts",total:0,search:""},job_seekers:{data:[],currentPage:1,lastPage:null,defaultUrl:"/api/admin/job-seekers",total:0,search:""},targetApplicationId:null}},mounted(){let e=document.getElementById("topScrollbar"),a=document.getElementById("table");e.onscroll=function(){a.scrollLeft=e.scrollLeft},a.onscroll=function(){e.scrollLeft=a.scrollLeft},flatpickr(".flatpickr"),$('[data-toggle="tooltip"]').tooltip(),$(".status-selector").on("change",function(){let s=$(this),l=s.attr("data-id");s.attr("current-status");let o=$(".update-application-status-form"+l),c=$("#update-application-status-modal"+l);o.find("#application_status").val(s.val()),c.modal("show")}),$(".modal").on("hidden.bs.modal",function(){const s='select[data-id="'+this.dataset.id+'"]';let l=$(s);l.val(l.attr("current-status"))}),$(".msg-close-btn").on("click",function(){$(this.dataset.target).addClass("d-none")});const n=document.querySelector('meta[name="csrf-token"]').getAttribute("value");let t=document.getElementsByClassName("submit-btn");for(let s of t)s.addEventListener("click",function(l){document.getElementById("successMsg").classList.add("d-none"),document.getElementById("errorMsg").classList.add("d-none");const o=this.form,c=o.querySelector("#application_status");let m={};m[c.name]=c.value,fetch(o.action,{method:"PATCH",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":n,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(m)}).then(r=>r.json()).then(r=>{if(r.errors)document.getElementById("errorMsg").classList.remove("d-none");else{document.getElementById("successMsg").classList.remove("d-none");const i='select[data-id="'+o.dataset.id+'"]';let d=document.querySelector(i);d.setAttribute("current-status",c.value),d.className="",d.classList.add(...statusCommonClasses),d.classList.add(...statusSpecificClasses[c.value])}})});document.body.clientWidth!=document.body.scrollWidth&&$("#header-main").addClass("w-110")},methods:{setToInput(e,a,n,t=null,s=null,l=null,o=null,c=null){const m=e+"Id",r=e+"Name";if(document.getElementById(m).value=a,document.getElementById(r).value=n,e=="jobSeeker"){let i=null;if(s&&(i=s,l)){let d;switch(s){case"Japanese":d=fluencies.japanese[l];break;case"Korean":d=fluencies.korean[l];break;case"Mandarin":d=fluencies.mandarin[l];break;default:d=fluencies.other[l];break}i+=": "+d}document.getElementById("nationality").value=t,document.getElementById("languageFluency").value=i,document.getElementById("currentSalary").value=o,document.getElementById("expectedSalary").value=c}},showInput(e,a,n){const t=a+e;document.getElementById(t).classList.remove("d-none"),document.getElementById(t).value=n.target.dataset.text,document.getElementById(t).focus();let s=new MouseEvent("click",{bubbles:!0});document.getElementById(t).dispatchEvent(s),n.target.classList.add("d-none"),this.targetApplicationId=e},hideInput(e,a,n){const t=a+"Text"+e;document.getElementById(t).classList.remove("d-none"),n.target.classList.add("d-none")},async fetchData(e,a=null,n=""){a||(a=this[e].defaultUrl+"?search="+n),this[e].data=[],this[e].search=n;const t=await(await fetch(a)).json();t.data.forEach(s=>{this[e].data.push(s)}),this[e].currentPage=t.current_page,this[e].startPage=t.from,this[e].lastPage=t.last_page,this[e].prevPageUrl=t.prev_page_url,this[e].nextPageUrl=t.next_page_url,this[e].links=t.links,this[e].total=t.total},async editInline(e,a=null,n=null,t=null,s=null,l=null,o=null,c=null,m=null){t||(t=this.targetApplicationId);const r=e+t;a||(a=document.getElementById(r).value),n||(n=a);const i=document.querySelector('meta[name="csrf-token"]').getAttribute("value");document.getElementById("successMsg").classList.add("d-none"),document.getElementById("errorMsg").classList.add("d-none");let d={};d[e]=a;const I="/admin/applications/"+t;fetch(I,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-TOKEN":i,"X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(d)}).then(p=>p.json()).then(p=>{const f=e+"Text"+t,h=e+"Tooltip"+t;if(p.errors)document.getElementById("errorMsg").classList.remove("d-none");else if(document.getElementById("successMsg").classList.remove("d-none"),document.getElementById(f).dataset.text=n,document.getElementById(h)&&(document.getElementById(h).dataset.originalTitle=n,n.length<15&&(document.getElementById(h).dataset.originalTitle="")),n.length>15&&(n=n.substring(0,15)+"&hellip;"),document.getElementById(f).innerHTML=n,e=="job_seeker_id"){let u=null;if(l&&(u=l,o)){let g;switch(l){case"Japanese":g=fluencies.japanese[o];break;case"Korean":g=fluencies.korean[o];break;case"Mandarin":g=fluencies.mandarin[o];break;default:g=fluencies.other[o];break}u+=": "+g}const E="languageFluency"+t;u&&u.length>15&&(u=u.substring(0,15)+"&hellip;"),document.getElementById(E).innerHTML=u||"-----";const y="nationality"+t;s&&s.length>15&&(s=s.substring(0,15)+"&hellip;"),document.getElementById(y).innerHTML=s||"-----";const b="currentSalary"+t;document.getElementById(b).innerHTML=c||"-----";const B="expectedSalary"+t;document.getElementById(B).innerHTML=m||"-----"}document.getElementById(r).classList.add("d-none"),document.getElementById(f).classList.remove("d-none")})}}});
